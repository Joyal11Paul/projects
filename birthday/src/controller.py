import pygame, sys
from src.plane import Plane

img_file = "assets/the_cake.png"

class Controller():
    def __init__(self):    
        pygame.init()
        pygame.event.pump()
        pygame.display.init()
        self.clock = pygame.time.Clock()
        self.width = 1000
        self.height = 800
        self.window = pygame.display.set_mode((self.width, self.height))
        self.plane = Plane()
        self.sprite_group = pygame.sprite.Group()
        self.sprite_group.add(self.plane)
        self.background = pygame.image.load(img_file)
        self.background = pygame.transform.scale(self.background, (self.width, self.height))
        self.bg_color = (255, 255, 255)
        self.trail_surface = pygame.Surface((self.width, self.height), pygame.SRCALPHA) 
        self.trail_surface.fill((0, 0, 0, 0))  
        
    def mainloop(self):
        running = True
        iter = 0
        
        while running:
            for event in pygame.event.get():
                if event.type == pygame.QUIT:
                    running = False
                if event.type == pygame.KEYDOWN:
                    if event.key == pygame.K_x:
                        running = False
                
                    
            points = [(1, 1), (128, 572), (132, 572), (138, 572), (144, 572), (149, 572), (154, 572), (160, 572), (167, 572), (174, 572), (179, 573), (185, 573), (189, 573), (193, 574), (199, 574), (204, 574), (208, 574), (211, 574), (216, 574), (219, 574), (223, 574), (227, 574), (230, 574), (234, 574), (242, 573), (247, 572), (253, 572), (259, 571), (266, 571), (270, 571), (277, 571), (282, 571), (290, 570), (296, 570), (303, 570), (308, 570), (315, 570), (320, 570), (326, 570), (330, 570), (336, 570), (342, 570), (348, 570), (353, 570), (358, 569), (363, 568), (373, 566), (377, 566), (378, 566), (390, 562), (410, 559), (424, 556), (438, 552), (447, 549), (463, 545), (471, 543), (480, 541), (487, 538), (491, 537), (494, 535), (498, 534), (502, 533), (505, 531), (509, 530), (514, 528), (519, 526), (525, 525), (530, 522), (534, 519), (540, 514), (547, 510), (552, 507), (560, 506), (564, 503), (571, 502), (577, 499), (580, 497), (584, 495), (588, 494), (591, 494), (594, 492), (599, 489), (604, 486), (608, 484), (614, 480), (618, 476), (622, 472), (629, 465), (633, 460), (640, 453), (646, 446), (650, 441), (658, 430), (662, 424), (668, 414), (672, 407), (676, 398), (680, 390), (683, 386), (687, 378), (689, 375), (689, 374), (690, 374), (691, 369), (692, 362), (696, 350), (698, 342), (703, 334), (706, 327), (708, 323), (709, 318), (710, 314), (712, 306), (713, 300), (713, 295), (713, 290), (713, 286), (713, 282), (713, 275), (711, 270), (710, 263), (710, 261), (708, 257), (707, 253), (705, 250), (703, 247), (702, 246), (700, 242), (698, 236), (697, 233), (695, 227), (695, 224), (693, 220), (693, 217), (690, 213), (689, 209), (688, 206), (686, 203), (683, 200), (681, 198), (676, 192), (674, 190), (668, 186), (662, 182), (659, 180), (657, 178), (653, 175), (650, 174), (646, 172), (640, 168), (637, 166), (632, 166), (630, 164), (627, 162), (624, 162), (622, 161), (620, 161), (618, 161), (614, 161), (611, 161), (608, 161), (606, 161), (602, 161), (599, 161), (596, 162), (592, 163), (589, 166), (587, 166), (585, 166), (582, 167), (581, 169), (578, 170), (575, 171), (573, 173), (570, 174), (566, 177), (562, 179), (559, 181), (557, 182), (554, 184), (554, 186), (552, 187), (550, 190), (548, 193), (546, 195), (545, 198), (543, 202), (542, 203), (541, 204), (540, 206), (538, 209), (538, 210), (536, 213), (535, 214), (534, 215), (533, 218), (531, 220), (530, 222), (529, 225), (526, 229), (525, 230), (524, 232), (522, 235), (522, 237), (519, 239), (518, 240), (518, 242), (516, 244), (516, 245), (515, 246), (514, 246), (514, 248), (514, 250), (512, 250), (512, 252), (512, 253), (511, 254), (511, 256), (514, 258), (514, 257), (513, 255), (511, 251), (510, 249), (509, 243), (507, 237), (505, 231), (501, 222), (498, 218), (494, 210), (489, 202), (486, 197), (481, 187), (474, 177), (472, 173), (468, 166), (465, 162), (461, 156), (458, 154), (454, 148), (450, 146), (445, 143), (438, 139), (432, 136), (429, 134), (424, 132), (420, 131), (414, 130), (407, 130), (402, 130), (397, 130), (392, 130), (389, 130), (384, 130), (380, 129), (374, 129), (366, 128), (360, 127), (354, 126), (349, 125), (344, 123), (339, 122), (335, 122), (331, 122), (327, 122), (320, 123), (314, 124), (309, 125), (303, 126), (301, 127), (296, 129), (292, 130), (286, 132), (282, 134), (278, 136), (274, 139), (270, 142), (269, 142), (266, 145), (262, 148), (260, 150), (255, 154), (253, 158), (248, 163), (243, 168), (241, 170), (238, 173), (238, 174), (238, 176), (238, 178), (235, 182), (229, 186), (218, 194), (208, 202), (203, 207), (197, 214), (194, 218), (192, 226), (190, 231), (189, 238), (188, 246), (188, 249), (188, 257), (188, 262), (189, 267), (190, 271), (190, 274), (193, 278), (194, 282), (197, 288), (198, 294), (201, 298), (203, 304), (205, 310), (208, 314), (210, 319), (212, 323), (216, 329), (218, 334), (221, 341), (224, 349), (226, 352), (229, 356), (230, 359), (234, 365), (236, 370), (238, 373), (240, 377), (241, 378), (242, 379), (248, 386), (254, 394), (263, 410), (272, 425), (278, 434), (283, 444), (288, 453), (292, 458), (299, 467), (310, 478), (315, 484), (322, 490), (327, 495), (333, 499), (344, 504), (361, 513), (372, 520), (377, 522), (380, 525), (382, 526), (382, 523), (390, 523), (401, 523), (418, 527), (427, 530), (440, 534), (451, 538), (458, 540), (466, 544), (476, 549), (482, 551), (494, 556), (499, 558), (506, 561), (514, 563), (518, 565), (526, 566), (530, 566), (541, 567), (547, 568), (555, 569), (562, 569), (566, 569), (574, 569), (580, 569), (586, 568), (592, 567), (595, 567), (602, 566), (610, 564), (614, 564), (620, 564), (626, 563), (630, 562), (635, 561), (639, 560), (645, 559), (649, 559), (651, 558), (662, 557), (682, 556), (696, 556), (710, 556), (721, 556), (728, 557), (739, 557), (745, 558), (754, 558), (758, 558), (760, 558), (764, 558), (770, 557), (775, 557), (784, 556), (789, 555), (798, 554), (801, 554), (808, 553), (815, 551), (822, 550), (827, 550), (834, 549), (839, 548), (844, 547), (847, 546), (853, 546), (856, 546), (859, 546), (862, 546), (866, 546), (870, 546), (874, 546), (878, 546), (881, 547), (884, 547), (886, 547), (889, 547), (891, 547), (895, 546), (898, 546), (902, 546), (906, 544), (908, 543), (912, 542), (914, 542), (916, 542), (917, 542), (918, 541), (919, 541), (920, 541), (922, 540), (922, 539)]
              
            self.plane.rect.x = points[iter][0]
            self.plane.rect.y = points[iter][1]
            iter += 1
            
            
            pygame.display.flip()
            
            self.window.blit(self.background, (0, 0))
            
            self.sprite_group.draw(self.window)
            pygame.draw.circle(self.trail_surface, color=(255, 0, 0), center=(points[iter][0], points[iter][1] + 110), radius = 10)
            self.window.blit(self.trail_surface, (0, 0))
            self.clock.tick(25)    
            
        pygame.quit()
        sys.exit()
        
        '''
        points = [(1, 1)]
        drawing = False
        
        
        elif event.type == pygame.MOUSEBUTTONDOWN:
                # Start tracing when mouse button is pressed
                    drawing = True
                    points.append(event.pos)
                elif event.type == pygame.MOUSEBUTTONUP:
                    drawing = False
                elif event.type == pygame.MOUSEMOTION and drawing:
                    points.append(event.pos)
        
        
        self.plane.rect.x = points[-1][0]
        self.plane.rect.y = points[-1][1]
        '''